Описание API
============

Запросы между клиентом и сервером передаются в виде JSON-объекта.
Первая пара ключ:значение определяет наименование метода.

Ниже перечислены все возможные поля JSON-файла


.. _type:

Type
----

В объекте Type передается тип метода.

.. list-table::
    :widths: 15 15 15 55
    :header-rows: 1

    * - Ключ
      - Тип
      - Обязательный
      - Описание
    * - type
      - str
      - Yes
      - Уникальное имя метода из следующего списка: :ref:`all_chat`, :ref:`all_messages`, :ref:`authentication`,
        :ref:`get_update`, :ref:`register_user`, :ref:`send_message`, :ref:`user_info`.


.. _data:

Data
----

В объекте Data передается основной массив информации.

.. list-table::
    :widths: 15 15 15 55
    :header-rows: 1

    * - Ключ
      - Тип
      - Обязательный
      - Описание
    * - time
      - int
      - Yes
      - Время на сервере, в секунда со времени началы эпохи (Unix-время).
    * - chat
      - :ref:`chat`
      - No
      - Объект данных в виде массива типа dict.
    * - message
      - :ref:`message`
      - No
      - Объект данных в виде массива типа dict.
    * - user
      - :ref:`user`
      - No
      - Объект данных в виде массива типа dict.
    * - meta
      - str
      - No
      - Зарезервировано.


.. _chat:

Chat
----

В объекте Chat передается полная информация о чате (канале, группе).

.. list-table::
    :widths: 15 15 15 55
    :header-rows: 1

    * - Ключ
      - Тип
      - Обязательный
      - Описание
    * - id
      - int
      - Yes
      - Уникальный номер чата.
    * - time
      - int
      - Yes
      - Время обновления чата.
    * - type
      - str
      - Yes
      - Тип чата: chat (2 пишут, 2 читают), channel (1 пишет, многие читают), group (многие пишут, многие читают).
    * - title
      - str
      - Yes
      - Персональное имя чата (может быть не уникальным).
    * - info
      - str
      - No
      - Описание канала.


.. _message:

Message
-------

В объекте message передается информация о сообщении.

.. list-table::
    :widths: 15 15 15 55
    :header-rows: 1

    * - Ключ
      - Тип
      - Обязательный
      - Описание
    * - id
      - int
      - Yes
      - Уникальный номер сообщения.
    * - text
      - str
      - Yes
      - Текст сообщения.
    * - from_user
      - :ref:`from_user`
      - Yes
      - Объект в ввиде массива типа dict. Информация о пользователе который написал это сообщение.
    * - time
      - int
      - Yes
      - Время когда сообщение было написано.
    * - from_chat
      - :ref:`from_chat`
      - Yes
      - Объект в ввиде массива типа dict. К какому чату принадлежит это сообщение.
    * - file
      - :ref:`file`
      - No
      - Объект в ввиде массива типа dict. Файл прикреплённый к сообщению (аудио, видео, фото, документ).
    * - emoji
      - bytes
      - No
      - Тип емоджи (в виде файла).
    * - edited_message
      - :ref:`edited_message`
      - No
      - Объект в ввиде массива типа dict. Информация о редактировании сообщения, а так же о дате редактирования.
    * - reply_to
      - Any
      - No
      - Ссылка на цитируемое сообщение.


.. _from_user:

From_user
---------

в объекте from_user передается информация о пользователе который написал сообщение.

.. list-table::
    :widths: 15 15 15 55
    :header-rows: 1

    * - Ключ
      - Тип
      - Обязательный
      - Описание
    * - id
      - int
      - Yes
      - Уникальный номер пользователя.
    * - username
      - str
      - Yes
      - Имя пользователя.


.. _from_chat:

From_chat
---------

В объекте from_chat передается информация о id чата к которому принадлежит сообщение.

.. list-table::
    :widths: 15 15 15 55
    :header-rows: 1

    * - Ключ
      - Тип
      - Обязательный
      - Описание
    * - id
      - int
      - Yes
      - Уникальный номер чата

.. _file:

File
-----------

В объекте file передаются файлы, которые пользователь прикрепил к сообщению.

.. list-table::
    :widths: 15 15 15 55
    :header-rows: 1

    * - Ключ
      - Тип
      - Обязательный
      - Описание
    * - picture
      - bytes
      - No
      - Изображение.
    * - video
      - bytes
      - No
      - Видео.
    * - audio
      - bytes
      - No
      - Аудио.
    * - document
      - bytes
      - No
      - Документ.


.. _edited_message:

edited_message
--------------

В объекте edited_message передается информация об исправлении сообщения, а так же дата последнего редактирования.

.. list-table::
    :widths: 15 15 15 55
    :header-rows: 1

    * - Ключ
      - Тип
      - Обязательный
      - Описание
    * - time
      - int
      - Yes
      - Время когда пользователь последний раз исправил сообщение.
    * - status
      - bool
      - Yes
      - Статус сообщения (исправлено или нет).

.. _user:

User
----

В объекте user передается информация о пользователе (настройки пользователя).

.. list-table::
    :widths: 15 15 15 55
    :header-rows: 1

    * - Ключ
      - Тип
      - Обязательный
      - Описание
    * - id
      - int
      - Yes
      - Уникальный номер пользователя.
    * - bio
      - str
      - No
      - Информация о пользователе.
    * - avatar
      - bytes
      - No
      - Изображение пользователя.
    * - password
      - str
      - Yes
      - Пароль пользователя.
    * - login
      - str
      - Yes
      - Логин пользователя.
    * - is_bot
      - bool
      - Yes
      - Указывает на тип пользователя (бот или человек).
    * - auth_id
      - bytes
      - Yes
      - Хэш пароля.
    * - email
      - EmailStr
      - Yes
      - Контактная информация (адрес почты) пользователя.
    * - username
      - str
      - Yes
      - Имя пользователя (не уникальное).


.. _errors:

Errors
------

В объекте errors передается информация о результате выполнения запроса.
Коды ошибок (и их значения) такие же как и в протоколе HTTP.

.. list-table::
    :widths: 15 15 15 55
    :header-rows: 1

    * - Ключ
      - Тип
      - Обязательный
      - Описание
    * - id
      - int
      - Yes
      - Уникальный номер ошибки
    * - time
      - int
      - Yes
      - Время когда произошла ошибка
    * - status
      - str
      - Yes
      - Статус ошибки (в соответствии с таблицей кодов состояний HTTP-протокола)
    * - code
      - int
      - Yes
      - Код ошибки (в соответствии с таблицей кодов состояний HTTP-протокола)
    * - detail
      - str
      - Yes
      - Описание ошибки.


Объект Jsonapi
--------------

В объекте jsonapi передается версия протокола.

.. list-table::
    :widths: 15 15 15 55
    :header-rows: 1

    * - Ключ
      - Тип
      - Обязательный
      - Описание
    * - version
      - float
      - Yes
      - Версия протокола.


Объект Meta
-----------

Объект meta зарезервирован.

.. list-table::
    :widths: 15 15 15 55
    :header-rows: 1

    * - Ключ
      - Тип
      - Обязательный
      - Описание
    * - meta
      - Any
      - No
      - Зарезервировано.

